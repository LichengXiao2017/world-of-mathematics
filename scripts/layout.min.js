/* (c) 2016 Mathigon */
var scripts={};scripts.require=function(src,fn){var name=src.substring(src.lastIndexOf("/")+1,src.indexOf("."));scripts[name]?fn():jQuery.getScript(src).done(function(){scripts[name]=1,fn()})};var browser={width:window.innerWidth,height:window.innerHeight,html:document.getElementsByTagName("html")[0],isMobile:navigator.userAgent.match(/(iPhone|iPod|iPad|Android|Opera Mini|IEMobile|BlackBerry)/)?1:0,isRetina:(window.devicePixelRatio||1)>1.25?1:0,isTouch:!!("ontouchstart"in window)||window.DocumentTouch&&document instanceof DocumentTouch,imgExt:(window.devicePixelRatio||1)>1.25?"@2x":""};browser.resize=function(){if(browser.width=window.innerWidth,browser.height=window.innerHeight,article.resizeBoxes(),slider.loaded){for(slider.slideBack(),slider.backgrounds(),i=0;i<slider.n-1;++i)slider.translate(i,-browser.width,0);for(i=slider.n+1;i<6;++i)slider.translate(i,.5*browser.width,0)}},browser.pauseEvent=function(e){return e.stopPropagation(),e.preventDefault(),e.cancelBubble=!0,e.returnValue=!1,!1};var titles=["Introduction","Credits","Conic_Sections","Polygons_and_Polyhedra","Symmetry_and_Groups","Modelling_Space","Dimensions_and_Distortions","Fractals","Sequences","Functions_and_Series","Prime_Numbers","More_Number_Theory","Real_Irrational_Imaginary","Infinity","Combinatorics","Graph_Theory","Knots_Mazes_Labyrinths","Optimisation","Logic_and_Paradoxes","Axioms_and_Proof","Probability","Normal_Distribution","Random_Walks","Statistics","Game_Theory","Coding_and_Cryptography","Forces_Motion_Calculus","Waves_and_Music","Fluid_Dynamics","Chaos","Theory_of_Relativity","Quantum_Mechanics"],touchClick=function(el,fn,touchStartFn){this.el=el,this.fn=fn,touchStartFn&&(this.touchStartFn=touchStartFn),el.addEventListener("touchstart",this,!1),el.addEventListener("click",this,!1)};touchClick.prototype.handleEvent=function(event){switch(event.type){case"touchstart":this.touchStart(event);break;case"touchmove":this.touchMove(event);break;case"touchend":this.click(event);break;case"click":this.click(event)}},touchClick.prototype.touchStart=function(event){this.touchStartFn&&this.touchStartFn(),event.stopPropagation(),this.el.addEventListener("touchend",this,!1),document.body.addEventListener("touchmove",this,!1),this.startX=event.touches[0].clientX,this.startY=event.touches[0].clientY},touchClick.prototype.touchMove=function(event){(Math.abs(event.touches[0].clientX-this.startX)>10||Math.abs(event.touches[0].clientY-this.startY)>10)&&this.reset()},touchClick.prototype.click=function(event){event.stopPropagation(),this.reset(),this.fn(event)},touchClick.prototype.reset=function(){this.el.removeEventListener("touchend",this.click,!1),document.body.removeEventListener("touchmove",this.touchMove,!1)};var slider={loaded:0,n:0,start:{},delta:{},isScroll:0,iconBox:0,scrolling:0,lastScroll:0};slider.translate=function(i,dist,time,delay){slide=slider.elements[i],icons=slider.icons[i],slider.isTransf?(slide.style.webkitTransitionDuration=slide.style.MozTransitionDuration=slide.style.transitionDuration=icons.style.webkitTransitionDuration=icons.style.MozTransitionDuration=icons.style.transitionDuration=time+"s",slide.style.webkitTransitionDelay=slide.style.MozTransitionDelay=slide.style.transitionDelay=icons.style.webkitTransitionDelay=icons.style.MozTransitionDelay=icons.style.transitionDelay=delay?delay+"s":"0s",slide.style.webkitTransform=slide.style.MozTransform=slide.style.transform="translate3D("+dist+"px,0,0)",icons.style.webkitTransform=icons.style.MozTransform=icons.style.transform="translate3D("+.5*dist+"px,0,0)"):(slide.style.transform="translateX("+dist+"px)",slide.style.left=dist+"px")},slider.slideBack=function(){0!=slider.n&&slider.translate(slider.n-1,-1*browser.width,.5),slider.translate(slider.n,0,.5),5!=slider.n&&slider.translate(slider.n+1,.5*browser.width,.5)},slider.prev=function(){0!=slider.n&&(--slider.n,slider.container.className="on"+slider.n,slider.translate(slider.n,0,browser.isMobile?.5:.75),slider.translate(slider.n+1,.5*browser.width,browser.isMobile?.5:.75))},slider.next=function(){5!=slider.n&&(++slider.n,slider.container.className="on"+slider.n,slider.translate(slider.n,0,browser.isMobile?.5:.75),slider.translate(slider.n-1,-browser.width,browser.isMobile?.5:.75))},slider.slideTo=function(n){if(!(0>n||n>5||n==slider.n)){if(n-slider.n==1)return void slider.next();if(n-slider.n==-1)return void slider.prev();if(n>slider.n){slider.translate(slider.n,-browser.width,.5,0);for(var i=slider.n+1;n>i;++i)slider.translate(i,-browser.width,1,.2*(i-slider.n-1));slider.translate(n,0,.75,.2*(n-slider.n)-.15)}if(n<slider.n){slider.translate(slider.n,.5*browser.width,.5,0);for(var i=slider.n-1;i>n;--i)slider.translate(i,.5*browser.width,1,.2*(slider.n-i-1));slider.translate(n,0,.75,.2*(slider.n-n)-.15)}slider.n=n,slider.container.className="on"+n}},slider.touchstart=function(event){event.stopPropagation(),slider.start={x:event.touches[0].clientX,y:event.touches[0].clientY,time:+new Date},slider.delta={x:0,y:0},slider.scrolling=0},slider.touchmove=function(event){if(event.stopPropagation(),event.touches.length>1||event.scale&&1!==event.scale)return event.preventDefault(),void slider.slideBack();if(slider.delta.x=event.touches[0].clientX-slider.start.x,slider.delta.y=event.touches[0].clientY-slider.start.y,!slider.scrolling){if((browser.height<500||browser.width<530)&&Math.abs(slider.delta.x)<Math.abs(slider.delta.y))return slider.slideBack(),void(slider.scrolling=1);event.preventDefault(),(0==slider.n&&slider.delta.x>0||5==slider.n&&slider.delta.x<0)&&(slider.delta.x=slider.delta.x/(Math.abs(slider.delta.x)/browser.width+1)),slider.translate(slider.n,(slider.delta.x<0||0==slider.n?1:.5)*slider.delta.x,0),slider.delta.x<0?(0!=slider.n&&slider.translate(slider.n-1,-1*browser.width,0),5!=slider.n&&slider.translate(slider.n+1,.5*(browser.width+slider.delta.x),0)):0!=slider.n&&slider.translate(slider.n-1,-1*(browser.width-slider.delta.x),0)}},slider.touchend=function(event){if(event.preventDefault(),event.stopPropagation(),slider.scrolling)return!1;var duration=+new Date-slider.start.time,isValidSlide=Number(duration)<250&&Math.abs(slider.delta.x)>20||Math.abs(slider.delta.x)>browser.width/3,isPastBounds=0==slider.n&&slider.delta.x>0||5==slider.n&&slider.delta.x<0;isValidSlide&&!isPastBounds?slider.delta.x<0?slider.next():slider.prev():slider.slideBack()},slider.mousewheel=function(event){event.stopPropagation(),article.isOpen||browser.height<500||browser.width<530||(event.preventDefault(),event.wheelDeltaX<0&&slider.isScroll<=0&&5!=slider.n?(slider.isScroll=1,slider.next(),slider.timeout=setTimeout(function(){slider.isScroll=slider.lastScroll=0},1e3)):event.wheelDeltaX>0&&slider.isScroll>=0&&0!=slider.n&&(slider.isScroll=-1,slider.prev(),slider.timeout=setTimeout(function(){slider.isScroll=slider.lastScroll=0},1e3)))},slider.clickevent=function(el,fn){el.addEventListener("touchend",function(event){Math.abs(slider.delta.x)<20&&Math.abs(slider.delta.y)<20&&(event.preventDefault(),event.stopPropagation(),slider.slideBack(),fn())},!1),el.addEventListener("click",function(event){event.preventDefault(),event.stopPropagation(),fn()},!1)},slider.backgrounds=function(){var titles=["intro","space","numbers","logic","games","matter"],o=browser.width>browser.height?1:0,d=browser.isRetina+1,w=(o?browser.width:browser.height)*d,h=(o?browser.height:browser.width)*d;if(w>2100||h>1400)var n=2400;else if(w>1800||h>1200)var n=2100;else if(w>1500||h>1e3)var n=1800;else if(w>1200||h>800)var n=1500;else if(w>900||h>600)var n=1200;else var n=900;for(var i=0;6>i;++i)slider.elements[i].style.backgroundImage="url(images/backgrounds"+(o?"L":"P")+"/"+titles[i]+"_"+n+".jpg)"},slider.iconBoxClose=function(){if(slider.iconBox){var x=$(".topIcon.on");x.removeClass("on"),setTimeout(function(){x.find(".topIconFrame").css("display","none")},200),slider.iconBox=0}},slider.topIconOpen=function(icon){t=$(icon),s=t.parent(),u=s.find(".topIconFrame"),q=s.hasClass("on"),slider.iconBoxClose(),!q&&u[0]&&(u.css("display","block"),setTimeout(function(){s.addClass("on")},5),slider.iconBox=1)},slider.setup=function(){slider.loaded=1,slider.container=document.getElementById("chapters"),slider.elements=slider.container.children,slider.icons=[],slider.isTransf=!(void 0===slider.elements[0].style.webkitTransform&&void 0===slider.elements[0].style.MozTransform&&void 0===slider.elements[0].style.transform);for(var i=0;6>i;++i)slider.icons[i]=document.getElementById("n"+i);for(var i=1;6>i;++i)slider.translate(i,.5*browser.width,0);slider.backgrounds();for(var icons=document.getElementsByClassName("icon"),iconsN=icons.length,i=0;iconsN>i;++i){var url=icons[i].getAttribute("href");icons[i].style.backgroundImage="url(images/icons"+browser.imgExt+"/"+url+".jpg?1)",slider.clickevent(icons[i],function(x){return function(){article.open(x)}}(url))}document.addEventListener("keydown",function(e){var k=e.keyCode||e.which;article.isOpen||(39==k||40==k?slider.next():(37==k||38==k)&&slider.prev())},!1),browser.isTouch?(slider.container.addEventListener("touchstart",slider.touchstart,!1),slider.container.addEventListener("touchmove",slider.touchmove,!1),slider.container.addEventListener("touchend",slider.touchend,!1),slider.container.addEventListener("touchcancel",slider.touchend,!1)):(slider.container.addEventListener("mousewheel",slider.mousewheel,!1),slider.container.addEventListener("DOMMouseScroll",slider.mousewheel,!1)),slider.clickevent(document.getElementById("navP"),slider.prev),slider.clickevent(document.getElementById("navN"),slider.next);for(var i=0;6>i;++i)slider.clickevent(document.getElementById("nav"+i),function(x){return function(){slider.slideTo(x)}}(i));if(browser.height<500||browser.width<530){var contents=document.getElementsByClassName("contents");for(i=0;i<contents.length;++i)contents[i].addEventListener("touchstart",function(a){return function(event){a.scrollTop<=0&&(a.scrollTop=1),a.scrollTop+a.offsetHeight>=a.scrollHeight&&(a.scrollTop=a.scrollHeight-a.offsetHeight-1)}}(contents[i]),!1)}topIcons=document.getElementsByClassName("iconImg");for(var i=1;i<topIcons.length;++i)slider.clickevent(topIcons[i],function(x){return function(){slider.topIconOpen(topIcons[x])}}(i));slider.clickevent(slider.container,slider.iconBoxClose),slider.toggleFullScreen=function(){document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement?(document.cancelFullScreen?document.cancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen(),document.getElementById("iconFull").className="topIcon"):(document.body.requestFullscreen?document.body.requestFullscreen():document.body.msRequestFullScreen?document.body.msRequestFullScreen():document.body.mozRequestFullScreen?document.body.mozRequestFullScreen():document.body.webkitRequestFullscreen&&document.body.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT),document.getElementById("iconFull").className="topIcon on1")};var b=document.getElementById("body");b.mozRequestFullScreen||b.webkitRequestFullScreen||b.RequestFullScreen||b.msRequestFullscreen?slider.clickevent(document.getElementById("iconFull"),slider.toggleFullScreen):document.getElementById("iconFull").style.display="none",!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?"http":"https";d.getElementById(id)||(js=d.createElement(s),js.id=id,js.src=p+"://platform.twitter.com/widgets.js",fjs.parentNode.insertBefore(js,fjs))}(document,"script","twitter-wjs"),function(){var po=document.createElement("script");po.type="text/javascript",po.async=!0,po.src="https://apis.google.com/js/plusone.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(po,s)}()},article={shadow:document.getElementById("shadow"),isOpen:window.isHome?0:1,glossQ:0,count:window.isHome?0:1,vars:[]},article.elements=article.isOpen?[document.getElementById("A1")]:[],article.append=function(url,where){url=url.replace(".html",""),article.elements[article.count-1]=document.createElement("article");var a=article.elements[article.count-1],i=jQuery.inArray(url,titles);a.id="A"+article.count,a.className=where?where:"down",a.setAttribute("data-url",url);var headExt=browser.width>510||browser.height>510?browser.imgExt:"";a.innerHTML='<div class="topBarA"><div class="topBarBack"><div class="topBarIcon"></div>BACK</div><div class="topBarClose"><div class="topBarIcon"></div></div></div><div class="abox"><header style="background-image: url(images/headers'+headExt+"/"+url+".jpg?1), url(images/loading"+browser.imgExt+'.gif);"></header><div class="loading"></div></div><div class="bottomBar">'+(i>0?'<div class="bottomBarPrev ellipsis"><div class="topBarIcon"></div>'+titles[i-1].replace(/_/g," ").toUpperCase()+"</div>":"")+(31>i?'<div class="bottomBarNext ellipsis"><div class="topBarIcon"></div>'+titles[i+1].replace(/_/g," ").toUpperCase()+"</div>":"")+"</div>",document.body.appendChild(a),article.events(a,url,i)},article.events=function(a,url,i){url=url.replace(".html",""),a.addEventListener("click",article.close,!1),a.children[1].addEventListener("click",function(e){e.stopPropagation()},!1),a.addEventListener("touchstart",function(event){startTopScroll=a.scrollTop,startTopScroll<=0&&(a.scrollTop=1),startTopScroll+a.offsetHeight>=a.scrollHeight&&(a.scrollTop=a.scrollHeight-a.offsetHeight-1)},!1),new touchClick(a.children[0].children[0],function(e){e.stopPropagation(),article.goBack()}),i>0&&new touchClick(a.children[2].children[0],function(e){e.stopPropagation(),article.switchL(titles[i-1])}),31>i&&new touchClick(a.children[2].children[i?1:0],function(e){e.stopPropagation(),article["switch"](titles[i+1])})},article.open=function(url){url=url.replace(".html",""),slider.slideBack(),slider.iconBoxClose(),++article.count,article.isOpen=1,article.append(url,"down"),article.shadow.style.display="block",article.shadow.offsetTop,browser.html.className+=" reading",article.elements[article.count-1].className="",article.load(url)},article["switch"]=function(url){url=url.replace(".html",""),++article.count,article.append(url,"next"),article.elements[article.count-2].className="prev",article.elements[article.count-1].offsetTop,article.elements[article.count-1].className="",article.load(url)},article.switchL=function(url){url=url.replace(".html","");for(var i=0;i<article.count-1;++i)article.elements[i].remove();++article.count,article.append(url,"prev"),article.elements[article.count-2].className="next",article.elements[article.count-1].offsetTop,article.elements[article.count-1].className="noback",setTimeout(function(){article.elements[article.count-2].remove(),article.elements[article.count-1].id="A1",article.elements=[article.elements[article.count-1]],article.count=1,article.load(url)},1e3)},article.goBack=function(){if(article.count<2)return void article.close();article.elements[article.count-2].className="",article.elements[article.count-1].className="next",--article.count,setTimeout(function(){article.elements[article.count].remove()},1e3);var url=article.elements[article.count-1].getAttribute("data-url");url&&(document.title=url.replace(/_/g," ")+" | World of Mathematics",window.history.pushState&&window.history.pushState({url:url},"","/"+url)),article.vars=article.elements[article.count-1].children[1].children[2].getElementsByTagName("i")},article.close=function(){$("article").not("#A"+article.count).find("img").removeAttr("src"),$("article").not("#A"+article.count).remove(),$("article").css({transform:"translate3D(0,100%,0)"}),$(browser.html).removeClass("reading"),setTimeout(function(){article.shadow.style.display="none";for(var a=document.getElementsByTagName("article"),i=0;i<a.length;++i){for(var img=a[i].getElementsByTagName("img"),j=0;j<img.length;++j)img[j].src="";a[i].remove()}},1e3),article.isOpen=article.count=0,article.elements=[],document.title="Mathigon | World of Mathematics",window.history.pushState&&window.history.pushState({url:""},"","/"),slider.loaded||$("#chapters").load("/index.html #chapters",function(response,status,xhr,url){$(this).children().unwrap(),slider.setup(),slider.loaded=1})},article.load=function(url){url=url.replace(".html",""),ga&&ga("send","pageview",url),document.title=url.replace(/_/g," ")+" | World of Mathematics",window.history.pushState&&window.history.pushState({url:url},"","/"+url);var xhr=new XMLHttpRequest,abox=article.elements[article.count-1].children[1];xhr.onreadystatechange=function(){if(4==xhr.readyState){if(200==xhr.status){var doc=document.implementation.createHTMLDocument("example");doc.documentElement.innerHTML=xhr.responseText,abox.appendChild(document.adoptNode(doc.getElementsByClassName("tBody")[0]))}else{var msg="<p>Unfortunately we were not able to load "+url+". This  could be because you entered a wrong url or because the link you followed is broken.";abox.innerHTML+="<div class='tBody''><h2>"+xhr.status+" "+xhr.statusText+"</h2>"+msg+"</div>"}abox.getElementsByClassName("loading")[0].style.display="none",article.render(url)}},xhr.open("GET","/"+url,!0),xhr.send()},article.glossClose=function(){if(article.glossQ){var x=$(".gloss.on");x.removeClass("on"),setTimeout(function(){x.find(".glossFrame").css("display","none")},200),article.glossQ=0}},article.glossOpen=function(gloss){f=$(gloss).find(".glossFrame"),q=$(gloss).hasClass("on"),article.glossClose(),!q&&f[0]&&(f.css("display","block"),setTimeout(function(){$(gloss).addClass("on")},5),article.glossQ=1)},article.tabOpen=function(link,i){if(!$(link).hasClass("on")){$(link).addClass("on").siblings(".boxTabLink").removeClass("on"),link.hasAttribute("data-script")&&eval(link.getAttribute("data-script"));var $b=$(link).parents(".frame");if($b[0]||($b=$(link).parents(".box").find(".frame")),$b[0]){var $new=$($b[0].getElementsByClassName("boxWrap")[i]);$b.height($b.height()).addClass("changing").find(".boxWrap.on").removeClass("on"),setTimeout(function(){$b.addClass("animateHeight").height($new.height())},200),setTimeout(function(){$new.addClass("on")},400),setTimeout(function(){$b.removeClass("animateHeight changing").css("height","auto")},800)}}},article.makeGallery=function(g){var slidesN=$(g).hasClass("galleryLarge")?1:$(g).hasClass("gallerySmall")||browser.width<560?2:3;g.innerHTML+='<div class="GalDots"></div><div class="GalLeft"></div><div class="GalRight"></div>',slidesN>1&&(g.innerHTML+='<div class="GalLeftGrad"></div><div class="GalRightGrad"></div>');var pagination=g.getElementsByClassName("GalDots")[0],gallery=$(g).swiper({speed:600,loop:!0,slidesPerView:slidesN,calculateHeight:!0,pagination:pagination,wrapperClass:"GalWrap",paginationAsRange:!0,slideClass:"GalSlide"});browser.isTouch||$(g).on("mousewheel DOMMouseScroll",function(event){Math.abs(event.wheelDeltaX)<Math.abs(event.wheelDeltaY)||(event.preventDefault(),event.stopPropagation(),event.originalEvent.wheelDeltaX>0?gallery.swipePrev():gallery.swipeNext())}),g.getElementsByClassName("GalLeft")[0].addEventListener("click",function(){gallery.swipePrev()},!1),g.getElementsByClassName("GalRight")[0].addEventListener("click",function(){gallery.swipeNext()},!1)},article.makeVariable=function($i){if($i.setAttribute("data-exp",$i.innerHTML),$i.hasAttribute("data-var")){$i.className+=" var";var t=$i.getAttribute("data-var").split("|"),name=t[0],init=t[1],type=t[2],info=t[3]?t[3].split(","):[];$i.innerHTML=init,V[name]=init,"slider"==type?(V[name]=Number(init),$($i).addClass("varSlider").html('<span class="varSliderText"></span><span class="varSliderFrame" style="display: none;"><span class="varSliderBar" style="width: '+(init-Number(info[0]))/(Number(info[1])-Number(info[0]))*100+'%"></span></span>'),VarMoveData[name]={startPosition:0,startValue:0,distance:0,sense:Math.sqrt(info[2]/(info[1]-info[0])*1e3)+(browser.touch?10:2),start:function(nx,el){return function(event){this.startPosition=event.pageX||event.originalEvent.touches[0].pageX,this.startValue=V[nx],$(el).find(".varSliderFrame").fadeIn(100),browser.pauseEvent(event)}}(name,$i),move:function(event){this.distance=(event.pageX||event.originalEvent.touches[0].pageX)-this.startPosition,browser.pauseEvent(event)},end:function(el){return function(event){$(el).find(".varSliderFrame").fadeOut(100)}}($i),handle:function(nx,el){return function(event){VarMoveData[nx].move(event),V[nx]=Math.round(Math.max(info[0],Math.min(info[1],VarMoveData[nx].startValue+VarMoveData[nx].distance/VarMoveData[nx].sense))/info[2])*info[2],$(el).find(".varSliderBar").css("width",String((V[nx]-Number(info[0]))/(Number(info[1])-Number(info[0]))*100)+"%"),V.eval(),browser.pauseEvent(event)}}(name,$i)},$($i).bind("touchstart",function(nx){return function(event){VarMoveData[nx].start(event),browser.html.addEventListener("touchmove",VarMoveData[nx].handle,!1)}}(name)),$("html").bind("touchend",function(nx){return function(event){VarMoveData[nx].end(event),browser.html.removeEventListener("touchmove",VarMoveData[nx].handle,!1)}}(name)),$($i).mousedown(function(nx){return function(event){VarMoveData[nx].start(event),browser.html.addEventListener("mousemove",VarMoveData[nx].handle,!1)}}(name)),$("html").mouseup(function(nx){return function(event){VarMoveData[nx].end(event),browser.html.removeEventListener("mousemove",VarMoveData[nx].handle,!1)}}(name))):"bolean"==type?(V[name]=Number(init),$($i).click(function(){V[name]=1-V[name],V.eval()})):"switch"==type&&(V[name]=init,$($i).click(function(){var n=jQuery.inArray(V[name],info)+1;V[name]=n==info.length?info[0]:info[n],V.eval()}))}},article.render=function(url){art=article.elements[article.count-1],text=art.getElementsByClassName("tBody")[0];var headings=text.getElementsByTagName("h2"),tocString='<div class="tocIcon"></div><div class="toc"><div class="tocTitle">TABLE OF CONTENTS</div>';for(i=0;i<headings.length;++i)headings[i].className+=" tocLink"+i,tocString+='<div class="tocItem" data-tocId=".tocLink'+i+'">'+headings[i].innerHTML+"</div>";tocString+="</div>",art.children[1].children[0].innerHTML=tocString;var tocLinks=art.children[1].children[0].children[1].children;for(i=1;i<tocLinks.length;++i)tocLinks[i].addEventListener("click",function(){$(art).animate({scrollTop:$(art).find($(this).attr("data-tocID")).position().top+100},800)},!1);var adBox=text.getElementsByClassName("ad-box")[0],adHide=text.getElementsByClassName("ad-hide")[0];setTimeout(function(){(window.adsbygoogle=window.adsbygoogle||[]).push({})}),adHide&&adHide.addEventListener("click",function(){adBox.parentNode.removeChild(adBox)});var links=text.getElementsByTagName("a");for(i=0;i<links.length;++i){var aUrl=links[i].getAttribute("href").replace(".html","");"http"!=aUrl.substring(0,4)&&"mail"!=aUrl.substring(0,4)?$(links[i]).click(function(event){return event.preventDefault(),article["switch"]($(this).attr("href")),!1}):(links[i].setAttribute("target","_blank"),links[i].addEventListener("click",function(e){e.stopPropagation()},!1))}var gloss=text.getElementsByClassName("gloss");for(i=0;i<gloss.length;++i)gloss[i].innerHTML+='<span class="glossFrame off"><span class="glossBox">'+gloss[i].getAttribute("data-gloss")+'</span><span class="glossArrow"></span></span>',gloss[i].addEventListener("click",function(x){return function(e){e.stopPropagation(),article.glossOpen(gloss[x])}}(i),!1);if($(".glossFrame").on("click",function(e){e.stopPropagation()}),text.addEventListener("click",article.glossClose,!1),browser.isRetina){var imgs=text.getElementsByTagName("img");for(i=0;i<imgs.length;++i){var newSrc=imgs[i].getAttribute("src").replace(/(.+)(\.\w{3,4})$/,"$1@2x$2");imgs[i].setAttribute("src",newSrc)}}var tabs=text.getElementsByClassName("tabbed");for(i=0;i<tabs.length;++i){var tabLinks=tabs[i].getElementsByClassName("boxTabLink");for(j=0;j<tabLinks.length;++j)tabLinks[j].addEventListener("click",function(index){return function(){article.tabOpen(this,index)}}(j),!1)}for($(text).find(".extra .boxTitle").click(function(){var $extraBox=$(this).parent(".box"),$boxWrap=$extraBox.find(".boxWrap");if($extraBox.hasClass("on"))$boxWrap.css("height",$boxWrap.height()),setTimeout(function(){$boxWrap.addClass("animateHeight").css("height",0)},10),setTimeout(function(){$extraBox.removeClass("on")},510);else{$extraBox.addClass("on");var boxheight=$extraBox.find(".boxWrap > *").height()+30;$boxWrap.css("height",boxheight).addClass("animateHeight"),setTimeout(function(){$boxWrap.removeClass("animateHeight").css("height","auto")},510)}}),scripts.require("scripts/swiper-22.js",function(){var galleries=text.getElementsByClassName("galleryLarge");for(i=0;i<galleries.length;++i)article.makeGallery(galleries[i]);for(galleries=text.getElementsByClassName("gallerySmall"),i=0;i<galleries.length;++i)article.makeGallery(galleries[i]);for(galleries=text.getElementsByClassName("galleryTriple"),i=0;i<galleries.length;++i)article.makeGallery(galleries[i])}),article.vars=text.getElementsByTagName("i"),i=0;i<article.vars.length;++i)article.makeVariable(article.vars[i]);V.eval(),scripts[url]?scripts[url]():jQuery.getScript("resources/"+url+"/script.min.js").done(function(){scripts[url]()}),article.resizeBoxes()},article.resizeBoxes=function(){$(".resizable").each(function(){$t=$(this),$t.height(eval($t.attr("data-size").replace("w",$t.width()).replace("h",$t.height()))+"px")})};var V={},VarMoveData={};V.eval=function(){for(i=0;i<article.vars.length;++i)$i=$(article.vars[i]),$i.hasClass("varSlider")?$i.find(".varSliderText").html(eval(String($i.attr("data-exp")))):$i.attr("data-function")?eval($i.attr("data-function")):$i.html(eval(String($i.attr("data-exp"))))},$(document).ready(function(){if(browser.html.className+=browser.isMobile?" isMobile":" notMobile",article.isOpen){var url=window.location.href.substring(window.location.href.lastIndexOf("/")+1).replace(".html",""),a=article.elements[0];jQuery.inArray(url,titles);a.setAttribute("data-url",url),browser.isRetina&&(browser.width>510||browser.height>510)&&(a.children[1].children[0].style.backgroundImage="url(images/headers@2x/"+url+".jpg)"),article.events(a,url),article.render(url)}else slider.setup();window.addEventListener("resize",browser.resize,!1);var popped=!1,initialURL=location.href;window.addEventListener("popstate",function(){var initialPop=!popped&&location.href==initialURL;popped=!0,initialPop||(article.count?article.goBack():article.close())});var head=document.getElementsByTagName("head")[0];if("iPad"===navigator.platform){var portrait=browser.isRetina?"images/splash/splash-1536-2008.png":"images/splash/splash-768-1004.png",landscape=browser.isRetina?"images/splash/splash-2048-1496.png":"images/splash/splash-1024-748.png",link1=document.createElement("link");link1.setAttribute("rel","apple-touch-startup-image"),link1.setAttribute("media","screen and (orientation: portrait)"),link1.setAttribute("href",portrait),head.appendChild(link1);var link2=document.createElement("link");link2.setAttribute("rel","apple-touch-startup-image"),link2.setAttribute("media","screen and (orientation: landscape)"),link2.setAttribute("href",landscape),head.appendChild(link2)}else{var portrait=browser.isRetina?"images/splash/splash-640-920.png":"images/splash/splash-320-460.png";568==browser.height&&(portrait="images/splash/splash-640-1096.png");var link1=document.createElement("link");link1.setAttribute("rel","apple-touch-startup-image"),link1.setAttribute("href",portrait),head.appendChild(link1)}});